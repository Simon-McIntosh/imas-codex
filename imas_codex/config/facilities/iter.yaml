# ITER Organization - SDCC (Scientific Data Computing Center)
#
# Public facility configuration for graph and mappings.
# Infrastructure data is in iter_private.yaml (gitignored).

facility: iter
name: ITER Organization
machine: ITER
description: International Thermonuclear Experimental Reactor - SDCC
location: Cadarache, France

# SSH host alias - auto-detected as local when running on SDCC
# (hostname contains 'iter' so run() executes locally without SSH)
ssh_host: iter

# Data systems available at this facility
data_systems:
  - imas
  - mdsplus

# Data source configuration for signal discovery
# Used by: imas-codex discover signals iter
data_sources:
  # IMAS is ITER's native data format.
  imas:
    backends:
      - mdsplus
      - hdf5
    db_name: iter

# Data access patterns discovered during facility exploration.
data_access_patterns:
  primary_method: imas
  shot_identifier: shot
  signal_naming: >-
    IMAS IDS-based access: ids.equilibrium.time_slice[0].profiles_1d.psi.
    Python: entry.get('equilibrium'). IDSTool for interactive browsing.
  tree_organization: >-
    IMAS Interface Data Structures (IDS) organized by physics domain:
    equilibrium, core_profiles, edge_profiles, magnetics, etc.
    Each IDS has a standard schema defined by the IMAS Data Dictionary.
  key_tools:
    - imas
    - IDSTool
    - al5
    - imasdb
  wiki_signal_patterns:
    - IDS field documentation
    - Data Dictionary references
    - IMAS access code examples
  code_import_patterns:
    - import imas
    - from imas import
    - imasdb
    - al5

# Wiki/documentation sites (stored in private YAML, never graphed)
# Each site: {url, portal_page, site_type, auth_type, credential_service}
wiki_sites:
  - url: https://confluence.iter.org
    portal_page: IMP
    site_type: confluence
    access_method: direct  # Accessible from internet (no VPN/SSH needed)
    auth_type: session     # Username/password session login
    credential_service: iter
    ssh_available: false   # Confluence is a web service, no SSH route

# User info discovery configuration
# GECOS = General Comprehensive Operating System (5th field in /etc/passwd)
user_info:
  name_format: last_first  # ITER uses "Last First [EXT]" format
  gecos_suffix_pattern: "\\s+EXT$"  # Strip trailing " EXT" from names
  home_path_pattern: "^/home/ITER/([a-z0-9_-]+)(?:/|$)"  # /home/ITER/username
  lookup_tools:  # Ordered fallback list
    - getent   # POSIX standard, includes LDAP/NIS/SSSD
    - passwd   # /etc/passwd fallback
    - id       # existence check only