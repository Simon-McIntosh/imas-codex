# TCV Tokamak - Swiss Plasma Center (EPFL)
#
# Public facility configuration for graph and mappings.
# Infrastructure data is in tcv_private.yaml (gitignored).

facility: tcv
name: TCV Tokamak
machine: TCV
description: Swiss Plasma Center - TCV Tokamak at EPFL
location: Lausanne, Switzerland

# SSH connection (user configures ~/.ssh/config with this alias)
ssh_host: tcv

# Data systems available at this facility
data_systems:
  - mdsplus
  - tdi

# Data source configuration for signal discovery
# Used by: imas-codex discover data tcv
# Discovered via SSH queries 2026-02-05, shot 84000
data_sources:
  mdsplus:
    reference_shot: 85000  # Recent shot with good data coverage
    
    # Experimental data trees (processed diagnostics)
    # Verified accessible via MDSplus.Tree(name, 84000, 'READONLY')
    trees:
      # Core diagnostics
      - results      # Equilibrium reconstruction (LIUQE, FBTE) - 11463 nodes
      - magnetics    # Magnetic measurements - 514 nodes
      - thomson      # Thomson scattering Te/ne profiles - 1354 nodes
      - ecrh         # Electron cyclotron heating - 1017 nodes
      - diagz        # General diagnostics collection - 2057 nodes
      - power        # Power measurements (Ohmic, radiated) - 1715 nodes
      
      # Heating and plasma control
      - hybrid       # Hybrid heating system - 20055 nodes
      - pcs          # Plasma control system - 19121 nodes
      
      # Plasma analysis
      - atlas        # Plasma analysis framework - 42728 nodes
      
      # Shot metadata
      - tcv_shot     # Shot parameters and metadata - 82225 nodes
      
      # Support trees
      - base         # Base utilities and calibrations - 1176 nodes
    
    # TDI function directories for signal definitions
    # Count: tcv=246, devices=179, base=122, bitbus=96
    tdi_paths:
      - /usr/local/CRPP/tdi/tcv       # Main TCV data access functions
      - /usr/local/CRPP/tdi/devices   # Device drivers (ACQ400, DT196, etc)
      - /usr/local/CRPP/tdi/base      # Base MDSplus utilities
      - /usr/local/mdsplus/tdi        # Standard MDSplus TDI

# Wiki/documentation sites
# Direct HTTP access via Tequila SSO (EPFL authentication)
# Set credentials: imas-codex wiki credentials set tcv-wiki
wiki_sites:
  - url: https://spcwiki.epfl.ch/wiki
    portal_page: Portal:TCV
    site_type: mediawiki
    auth_type: tequila
    credential_service: tcv-wiki

# User info discovery configuration
# GECOS = General Comprehensive Operating System (5th field in /etc/passwd)
user_info:
  name_format: first_last  # Standard "First Last" format
  lookup_tools:  # Ordered fallback list
    - getent   # POSIX standard, includes LDAP/NIS/SSSD
    - passwd   # /etc/passwd fallback
    - id       # existence check only